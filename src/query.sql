CREATE TABLE EMP(
  EMPNO    INTEGER     PRIMARY KEY,
  ENAME    VARCHAR(20) NOT NULL   ,
  JOB      VARCHAR(20) NOT NULL   ,
  MGR      INTEGER     NULL       ,
  HIREDATE DATE        NOT NULL   ,
  SAL      INTEGER     NOT NULL   ,
  COMM     INTEGER     NULL       ,
  DEPTNO   INTEGER     NOT NULL
);

CREATE TABLE DEPT(
  DEPTNO    INTEGER     PRIMARY KEY,
  DNAME     VARCHAR(20) NOT NULL   ,
  LOC       VARCHAR(20) NOT NULL
);

CREATE TABLE SALGRADE(
  GRADE    INTEGER     PRIMARY KEY,
  LOSAL    VARCHAR(20) NOT NULL   ,
  HISAL    VARCHAR(20) NOT NULL
);

--Вставка в EMP
INSERT INTO "EMP" ("EMPNO", "ENAME", "JOB", "MGR", "HIREDATE", "SAL", "COMM", "DEPTNO") VALUES (7369, 'SMITH',    'CLERK', 7902, '12-17-1980',  800, NULL, 20);
INSERT INTO "EMP" ("EMPNO", "ENAME", "JOB", "MGR", "HIREDATE", "SAL", "COMM", "DEPTNO") VALUES (7499, 'ALLEN', 'SALESMAN', 7698, '02-20-1981', 1600,  300, 30);
INSERT INTO "EMP" ("EMPNO", "ENAME", "JOB", "MGR", "HIREDATE", "SAL", "COMM", "DEPTNO") VALUES (7521,  'WARD', 'SALESMAN', 7698, '02-22-1981', 1250,  500, 30);
INSERT INTO "EMP" ("EMPNO", "ENAME", "JOB", "MGR", "HIREDATE", "SAL", "COMM", "DEPTNO") VALUES (7566, 'JONES',  'MANAGER', 7839, '03-02-1981', 2975, NULL, 20);
INSERT INTO "EMP" ("EMPNO", "ENAME", "JOB", "MGR", "HIREDATE", "SAL", "COMM", "DEPTNO") VALUES (7654,'MARTIN', 'SALESMAN', 7698, '09-28-1981', 1250, 1400, 30);
INSERT INTO "EMP" ("EMPNO", "ENAME", "JOB", "MGR", "HIREDATE", "SAL", "COMM", "DEPTNO") VALUES (7698, 'BLAKE',  'MANAGER', 7839, '05-01-1981', 2850, NULL, 30);
INSERT INTO "EMP" ("EMPNO", "ENAME", "JOB", "MGR", "HIREDATE", "SAL", "COMM", "DEPTNO") VALUES (7782, 'CLARK',  'MANAGER', 7839, '06-09-1981', 2450, NULL, 10);
INSERT INTO "EMP" ("EMPNO", "ENAME", "JOB", "MGR", "HIREDATE", "SAL", "COMM", "DEPTNO") VALUES (7788, 'SCOTT',  'ANALYST', 7566, '12-01-1982', 3000, NULL, 20);
INSERT INTO "EMP" ("EMPNO", "ENAME", "JOB", "MGR", "HIREDATE", "SAL", "COMM", "DEPTNO") VALUES (7839,  'KING','PRESIDENT', NULL, '11-17-1981', 5000, NULL, 10);
INSERT INTO "EMP" ("EMPNO", "ENAME", "JOB", "MGR", "HIREDATE", "SAL", "COMM", "DEPTNO") VALUES (7844,'TURNER', 'SALESMAN', 7698, '09-08-1981', 1500,    0, 30);
INSERT INTO "EMP" ("EMPNO", "ENAME", "JOB", "MGR", "HIREDATE", "SAL", "COMM", "DEPTNO") VALUES (7876, 'ADAMS',    'CLERK', 7788, '01-12-1983', 1100, NULL, 20);
INSERT INTO "EMP" ("EMPNO", "ENAME", "JOB", "MGR", "HIREDATE", "SAL", "COMM", "DEPTNO") VALUES (7900, 'JAMES',    'CLERK', 7698, '12-03-1981',  950, NULL, 30);
INSERT INTO "EMP" ("EMPNO", "ENAME", "JOB", "MGR", "HIREDATE", "SAL", "COMM", "DEPTNO") VALUES (7902,  'FORD',  'ANALYST', 7566, '12-03-1981', 3000, NULL, 20);
INSERT INTO "EMP" ("EMPNO", "ENAME", "JOB", "MGR", "HIREDATE", "SAL", "COMM", "DEPTNO") VALUES (7934,'MILLER',    'CLERK', 7782, '01-23-1983', 1300, NULL, 10);

--Вставка в DEPT
INSERT INTO "DEPT" ("DEPTNO", "DNAME", "LOC") VALUES (10, 'ACCOUNTING', 'NEW YORK');
INSERT INTO "DEPT" ("DEPTNO", "DNAME", "LOC") VALUES (20, 'RESEARCH', 'DALLAS');
INSERT INTO "DEPT" ("DEPTNO", "DNAME", "LOC") VALUES (30, 'SALES', 'CHICAGO');
INSERT INTO "DEPT" ("DEPTNO", "DNAME", "LOC") VALUES (40, 'OPERATIONS', 'BOSTON');

--Вставка в SALGRADE
INSERT INTO "SALGRADE" ("GRADE", "LOSAL", "HISAL") VALUES (1,  700, 1200);
INSERT INTO "SALGRADE" ("GRADE", "LOSAL", "HISAL") VALUES (2, 1201, 1400);
INSERT INTO "SALGRADE" ("GRADE", "LOSAL", "HISAL") VALUES (3, 1401, 2000);
INSERT INTO "SALGRADE" ("GRADE", "LOSAL", "HISAL") VALUES (4, 2001, 3000);
INSERT INTO "SALGRADE" ("GRADE", "LOSAL", "HISAL") VALUES (5, 3001, 9999);

-- 1.Вывести фамилии всех сотрудников и отделы в которых они работают.
SELECT "EMP"."ENAME", "DEPT"."DNAME"
FROM "EMP","DEPT"
WHERE "EMP"."DEPTNO"="DEPT"."DEPTNO";

-- 2.Вывести фамилии, должности и зарплаты сотрудников, которым не положены комисcионные.
SELECT "ENAME", "JOB", "SAL"
FROM "EMP"
WHERE "COMM" IS NULL;

-- 3.Вывести количество сотрудников и среднюю зарплату в 20 отделе.
SELECT count("ENAME") as "EMP_COUNT", avg("SAL") as "SAL_AVG"
FROM "EMP"
WHERE "DEPTNO"=20;

-- 4.Вывести отделы в которых больше 3-х сотрудников. Посчитать количество сотрудников в таких отделах.
SELECT "DEPT"."DNAME", count("EMP"."DEPTNO") as "DNAME_COUNT"
FROM "EMP","DEPT"
WHERE "EMP"."DEPTNO"="DEPT"."DEPTNO"
GROUP BY "DEPT"."DNAME"
HAVING count("EMP"."DEPTNO")>3;

-- 5.Выведите фамилии сотрудников, название их отделов, города расположения отделов, зарплату сотрудников и уровень их зарплаты.
-- Отсортировать результат в порядке возрастания уровня зарплаты, если уровень зарплаты совпадает, то по зарплате.
SELECT EMP.ENAME,DEPT.DNAME,DEPT.LOC,EMP.SAL,t.grade as GRADE
FROM EMP,DEPT,(SELECT "EMP"."SAL" as sal,"SALGRADE"."GRADE" as grade
               FROM "EMP","SALGRADE"
               WHERE "EMP"."SAL" BETWEEN "SALGRADE"."LOSAL" AND "SALGRADE"."HISAL") as t
WHERE EMP.DEPTNO=DEPT.DEPTNO AND EMP.SAL=t.sal
GROUP BY EMP.ENAME,DEPT.DNAME,DEPT.LOC,EMP.SAL,t.grade